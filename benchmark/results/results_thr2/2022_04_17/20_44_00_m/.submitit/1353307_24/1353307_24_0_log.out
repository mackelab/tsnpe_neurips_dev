submitit INFO (2022-04-17 21:13:17,681) - Starting with JobEnvironment(job_id=1353307_24, hostname=slurm-cpu-hm-7.novalocal, local_rank=0(1), node=0(1), global_rank=0(1))
submitit INFO (2022-04-17 21:13:17,682) - Loading pickle: /mnt/qb/macke/mdeistler57/tsnpe_collection/benchmark/benchmark/../results/2022_04_17/20_44_00_m/.submitit/1353307_24/1353307_24_submitted.pkl
[2022-04-17 21:13:43,806][__main__][INFO] - algorithm:
  name: tsnpe
  params:
    num_rounds: 10
    neural_net: nsf
    hidden_features: 50
    simulation_batch_size: 1000
    training_batch_size: 10000
    z_score_x: independent
    z_score_theta: independent
    num_samples_to_estimate_support: 1000000
    allowed_false_negatives: 1.0e-05
    use_constrained_prior: false
    constrained_prior_quanitle: 0.0
    max_num_epochs: 100000
task:
  name: gaussian_linear
  num_simulations: 1000
  num_observation: 9
compute_metrics: true
seed: null

[2022-04-17 21:13:43,807][__main__][INFO] - sbibm version: 1.0.7
[2022-04-17 21:13:43,807][__main__][INFO] - Seed not specified, generating random seed for replicability
[2022-04-17 21:13:43,808][__main__][INFO] - Random seed: 1118690873
[2022-04-17 21:13:45,578][__main__][INFO] - Start run
[2022-04-17 21:13:45,662][benchmark.run_tsnpe][INFO] - Running SNPE
[2022-04-17 21:13:45,663][benchmark.run_tsnpe][WARNING] - Reduced simulation_batch_size to num_simulation_per_round
[2022-04-17 21:13:45,663][benchmark.run_tsnpe][WARNING] - Reduced training_batch_size to num_simulation_per_round
 Training neural network. Epochs trained: 1 Training neural network. Epochs trained: 2 Training neural network. Epochs trained: 3 Training neural network. Epochs trained: 4 Training neural network. Epochs trained: 5 Training neural network. Epochs trained: 6 Training neural network. Epochs trained: 7 Training neural network. Epochs trained: 8 Training neural network. Epochs trained: 9 Training neural network. Epochs trained: 10 Training neural network. Epochs trained: 11 Training neural network. Epochs trained: 12 Training neural network. Epochs trained: 13 Training neural network. Epochs trained: 14 Training neural network. Epochs trained: 15 Training neural network. Epochs trained: 16 Training neural network. Epochs trained: 17 Training neural network. Epochs trained: 18 Training neural network. Epochs trained: 19 Training neural network. Epochs trained: 20 Training neural network. Epochs trained: 21 Training neural network. Epochs trained: 22 Training neural network. Epochs trained: 23 Training neural network. Epochs trained: 24 Training neural network. Epochs trained: 25 Training neural network. Epochs trained: 26 Training neural network. Epochs trained: 27 Training neural network. Epochs trained: 28 Training neural network. Epochs trained: 29 Training neural network. Epochs trained: 30 Training neural network. Epochs trained: 31 Training neural network. Epochs trained: 32 Training neural network. Epochs trained: 33 Training neural network. Epochs trained: 34 Training neural network. Epochs trained: 35 Training neural network. Epochs trained: 36 Training neural network. Epochs trained: 37 Training neural network. Epochs trained: 38 Training neural network. Epochs trained: 39 Training neural network. Epochs trained: 40 Training neural network. Epochs trained: 41 Training neural network. Epochs trained: 42 Training neural network. Epochs trained: 43 Training neural network. Epochs trained: 44 Training neural network. Epochs trained: 45 Training neural network. Epochs trained: 46 Training neural network. Epochs trained: 47 Training neural network. Epochs trained: 48 Training neural network. Epochs trained: 49 Training neural network. Epochs trained: 50 Training neural network. Epochs trained: 51 Training neural network. Epochs trained: 52 Training neural network. Epochs trained: 53 Training neural network. Epochs trained: 54 Training neural network. Epochs trained: 55 Neural network successfully converged after 55 epochs.
        -------------------------
        ||||| ROUND 1 STATS |||||:
        -------------------------
        Epochs trained: 55
        Best validation performance: -4.1074
        -------------------------
        
lps tensor([ 0.2890, -5.8159, -2.0494,  ..., -7.9558, -2.0662, -0.3890])
self.thr tensor(-17.6469)
Remaining: -9895The classifier rejected 0.0500% of all samples. You will get a speed-up of 0.1%.
Remaining: 3Remaining: -9992The classifier rejected 0.0400% of all samples. You will get a speed-up of 0.0%.
 Training neural network. Epochs trained: 1 Training neural network. Epochs trained: 2 Training neural network. Epochs trained: 3 Training neural network. Epochs trained: 4 Training neural network. Epochs trained: 5 Training neural network. Epochs trained: 6 Training neural network. Epochs trained: 7 Training neural network. Epochs trained: 8 Training neural network. Epochs trained: 9 Training neural network. Epochs trained: 10 Training neural network. Epochs trained: 11 Training neural network. Epochs trained: 12 Training neural network. Epochs trained: 13 Training neural network. Epochs trained: 14 Training neural network. Epochs trained: 15 Training neural network. Epochs trained: 16 Training neural network. Epochs trained: 17 Training neural network. Epochs trained: 18 Training neural network. Epochs trained: 19 Training neural network. Epochs trained: 20 Training neural network. Epochs trained: 21 Neural network successfully converged after 21 epochs.
        -------------------------
        ||||| ROUND 1 STATS |||||:
        -------------------------
        Epochs trained: 21
        Best validation performance: -0.7854
        -------------------------
        
lps tensor([-2.4578,  0.4276, -0.3320,  ..., -0.5628, -2.0496, -1.7584])
self.thr tensor(-17.9702)
Remaining: -9898The classifier rejected 0.0200% of all samples. You will get a speed-up of 0.0%.
Remaining: 5Remaining: -9993The classifier rejected 0.0350% of all samples. You will get a speed-up of 0.0%.
 Training neural network. Epochs trained: 1 Training neural network. Epochs trained: 2 Training neural network. Epochs trained: 3 Training neural network. Epochs trained: 4 Training neural network. Epochs trained: 5 Training neural network. Epochs trained: 6 Training neural network. Epochs trained: 7 Training neural network. Epochs trained: 8 Training neural network. Epochs trained: 9 Training neural network. Epochs trained: 10 Training neural network. Epochs trained: 11 Training neural network. Epochs trained: 12 Training neural network. Epochs trained: 13 Training neural network. Epochs trained: 14 Training neural network. Epochs trained: 15 Training neural network. Epochs trained: 16 Training neural network. Epochs trained: 17 Training neural network. Epochs trained: 18 Training neural network. Epochs trained: 19 Training neural network. Epochs trained: 20 Training neural network. Epochs trained: 21 Training neural network. Epochs trained: 22 Training neural network. Epochs trained: 23 Training neural network. Epochs trained: 24 Training neural network. Epochs trained: 25 Training neural network. Epochs trained: 26 Training neural network. Epochs trained: 27 Training neural network. Epochs trained: 28 Training neural network. Epochs trained: 29 Training neural network. Epochs trained: 30 Training neural network. Epochs trained: 31 Training neural network. Epochs trained: 32 Training neural network. Epochs trained: 33 Training neural network. Epochs trained: 34 Training neural network. Epochs trained: 35 Training neural network. Epochs trained: 36 Training neural network. Epochs trained: 37 Training neural network. Epochs trained: 38 Training neural network. Epochs trained: 39 Training neural network. Epochs trained: 40 Training neural network. Epochs trained: 41 Training neural network. Epochs trained: 42 Training neural network. Epochs trained: 43 Training neural network. Epochs trained: 44 Training neural network. Epochs trained: 45 Training neural network. Epochs trained: 46 Training neural network. Epochs trained: 47 Training neural network. Epochs trained: 48 Training neural network. Epochs trained: 49 Training neural network. Epochs trained: 50 Training neural network. Epochs trained: 51 Training neural network. Epochs trained: 52 Training neural network. Epochs trained: 53 Training neural network. Epochs trained: 54 Training neural network. Epochs trained: 55 Training neural network. Epochs trained: 56 Training neural network. Epochs trained: 57 Training neural network. Epochs trained: 58 Training neural network. Epochs trained: 59 Neural network successfully converged after 59 epochs.
        -------------------------
        ||||| ROUND 1 STATS |||||:
        -------------------------
        Epochs trained: 59
        Best validation performance: -1.1306
        -------------------------
        
lps tensor([ 2.6319, -2.7933,  4.2152,  ...,  0.1669,  1.4453,  2.3224])
self.thr tensor(-17.4931)
Remaining: -9879The classifier rejected 0.2100% of all samples. You will get a speed-up of 0.2%.
Remaining: 22Remaining: -9960The classifier rejected 0.2000% of all samples. You will get a speed-up of 0.2%.
 Training neural network. Epochs trained: 1 Training neural network. Epochs trained: 2 Training neural network. Epochs trained: 3 Training neural network. Epochs trained: 4 Training neural network. Epochs trained: 5 Training neural network. Epochs trained: 6 Training neural network. Epochs trained: 7 Training neural network. Epochs trained: 8 Training neural network. Epochs trained: 9 Training neural network. Epochs trained: 10 Training neural network. Epochs trained: 11 Training neural network. Epochs trained: 12 Training neural network. Epochs trained: 13 Training neural network. Epochs trained: 14 Training neural network. Epochs trained: 15 Training neural network. Epochs trained: 16 Training neural network. Epochs trained: 17 Training neural network. Epochs trained: 18 Training neural network. Epochs trained: 19 Training neural network. Epochs trained: 20 Training neural network. Epochs trained: 21 Training neural network. Epochs trained: 22 Training neural network. Epochs trained: 23 Training neural network. Epochs trained: 24 Training neural network. Epochs trained: 25 Training neural network. Epochs trained: 26 Training neural network. Epochs trained: 27 Training neural network. Epochs trained: 28 Training neural network. Epochs trained: 29 Training neural network. Epochs trained: 30 Neural network successfully converged after 30 epochs.
        -------------------------
        ||||| ROUND 1 STATS |||||:
        -------------------------
        Epochs trained: 30
        Best validation performance: -0.5990
        -------------------------
        
lps tensor([ 3.2851e+00, -2.9296e+00, -4.6690e-01,  ..., -8.0405e-01,
        -1.7986e-03, -1.6874e+00])
self.thr tensor(-16.4097)
Remaining: -9837The classifier rejected 0.6300% of all samples. You will get a speed-up of 0.6%.
Remaining: 58Remaining: -9885The classifier rejected 0.5750% of all samples. You will get a speed-up of 0.6%.
 Training neural network. Epochs trained: 1 Training neural network. Epochs trained: 2 Training neural network. Epochs trained: 3 Training neural network. Epochs trained: 4 Training neural network. Epochs trained: 5 Training neural network. Epochs trained: 6 Training neural network. Epochs trained: 7 Training neural network. Epochs trained: 8 Training neural network. Epochs trained: 9 Training neural network. Epochs trained: 10 Training neural network. Epochs trained: 11 Training neural network. Epochs trained: 12 Training neural network. Epochs trained: 13 Training neural network. Epochs trained: 14 Training neural network. Epochs trained: 15 Training neural network. Epochs trained: 16 Training neural network. Epochs trained: 17 Training neural network. Epochs trained: 18 Training neural network. Epochs trained: 19 Training neural network. Epochs trained: 20 Training neural network. Epochs trained: 21 Neural network successfully converged after 21 epochs.
        -------------------------
        ||||| ROUND 1 STATS |||||:
        -------------------------
        Epochs trained: 21
        Best validation performance: -0.1695
        -------------------------
        
lps tensor([ 4.7019, -1.7229, -4.4891,  ...,  0.6127,  0.3134, -0.5207])
self.thr tensor(-16.5208)
Remaining: -9853The classifier rejected 0.4700% of all samples. You will get a speed-up of 0.5%.
Remaining: 44Remaining: -9913The classifier rejected 0.4350% of all samples. You will get a speed-up of 0.4%.
 Training neural network. Epochs trained: 1 Training neural network. Epochs trained: 2 Training neural network. Epochs trained: 3 Training neural network. Epochs trained: 4 Training neural network. Epochs trained: 5 Training neural network. Epochs trained: 6 Training neural network. Epochs trained: 7 Training neural network. Epochs trained: 8 Training neural network. Epochs trained: 9 Training neural network. Epochs trained: 10 Training neural network. Epochs trained: 11 Training neural network. Epochs trained: 12 Training neural network. Epochs trained: 13 Training neural network. Epochs trained: 14 Training neural network. Epochs trained: 15 Training neural network. Epochs trained: 16 Training neural network. Epochs trained: 17 Training neural network. Epochs trained: 18 Training neural network. Epochs trained: 19 Training neural network. Epochs trained: 20 Training neural network. Epochs trained: 21 Neural network successfully converged after 21 epochs.
        -------------------------
        ||||| ROUND 1 STATS |||||:
        -------------------------
        Epochs trained: 21
        Best validation performance: 0.6751
        -------------------------
        
lps tensor([-3.4997,  1.8759,  0.0288,  ...,  1.4647,  0.8531,  1.1841])
self.thr tensor(-17.4639)
Remaining: -9855The classifier rejected 0.4500% of all samples. You will get a speed-up of 0.5%.
Remaining: 37Remaining: -9934The classifier rejected 0.3300% of all samples. You will get a speed-up of 0.3%.
 Training neural network. Epochs trained: 1 Training neural network. Epochs trained: 2 Training neural network. Epochs trained: 3 Training neural network. Epochs trained: 4 Training neural network. Epochs trained: 5 Training neural network. Epochs trained: 6 Training neural network. Epochs trained: 7 Training neural network. Epochs trained: 8 Training neural network. Epochs trained: 9 Training neural network. Epochs trained: 10 Training neural network. Epochs trained: 11 Training neural network. Epochs trained: 12 Training neural network. Epochs trained: 13 Training neural network. Epochs trained: 14 Training neural network. Epochs trained: 15 Training neural network. Epochs trained: 16 Training neural network. Epochs trained: 17 Training neural network. Epochs trained: 18 Training neural network. Epochs trained: 19 Training neural network. Epochs trained: 20 Training neural network. Epochs trained: 21 Neural network successfully converged after 21 epochs.
        -------------------------
        ||||| ROUND 1 STATS |||||:
        -------------------------
        Epochs trained: 21
        Best validation performance: 0.4324
        -------------------------
        
lps tensor([ 1.2390,  4.7408, -3.5156,  ...,  2.1923, -5.2570, -7.9138])
self.thr tensor(-16.1453)
Remaining: -9837The classifier rejected 0.6300% of all samples. You will get a speed-up of 0.6%.
Remaining: 58Remaining: -9875The classifier rejected 0.6250% of all samples. You will get a speed-up of 0.6%.
 Training neural network. Epochs trained: 1 Training neural network. Epochs trained: 2 Training neural network. Epochs trained: 3 Training neural network. Epochs trained: 4 Training neural network. Epochs trained: 5 Training neural network. Epochs trained: 6 Training neural network. Epochs trained: 7 Training neural network. Epochs trained: 8 Training neural network. Epochs trained: 9 Training neural network. Epochs trained: 10 Training neural network. Epochs trained: 11 Training neural network. Epochs trained: 12 Training neural network. Epochs trained: 13 Training neural network. Epochs trained: 14 Training neural network. Epochs trained: 15 Training neural network. Epochs trained: 16 Training neural network. Epochs trained: 17 Training neural network. Epochs trained: 18 Training neural network. Epochs trained: 19 Training neural network. Epochs trained: 20 Training neural network. Epochs trained: 21 Training neural network. Epochs trained: 22 Training neural network. Epochs trained: 23 Training neural network. Epochs trained: 24 Training neural network. Epochs trained: 25 Training neural network. Epochs trained: 26 Training neural network. Epochs trained: 27 Neural network successfully converged after 27 epochs.
        -------------------------
        ||||| ROUND 1 STATS |||||:
        -------------------------
        Epochs trained: 27
        Best validation performance: -0.8541
        -------------------------
        
lps tensor([-2.8324,  1.4234, -1.7308,  ...,  3.2202, -1.1449, -1.4237])
self.thr tensor(-16.4122)
Remaining: -9807The classifier rejected 0.9300% of all samples. You will get a speed-up of 0.9%.
Remaining: 85Remaining: -9819The classifier rejected 0.9050% of all samples. You will get a speed-up of 0.9%.
 Training neural network. Epochs trained: 1 Training neural network. Epochs trained: 2 Training neural network. Epochs trained: 3 Training neural network. Epochs trained: 4 Training neural network. Epochs trained: 5 Training neural network. Epochs trained: 6 Training neural network. Epochs trained: 7 Training neural network. Epochs trained: 8 Training neural network. Epochs trained: 9 Training neural network. Epochs trained: 10 Training neural network. Epochs trained: 11 Training neural network. Epochs trained: 12 Training neural network. Epochs trained: 13 Training neural network. Epochs trained: 14 Training neural network. Epochs trained: 15 Training neural network. Epochs trained: 16 Training neural network. Epochs trained: 17 Training neural network. Epochs trained: 18 Training neural network. Epochs trained: 19 Training neural network. Epochs trained: 20 Training neural network. Epochs trained: 21 Neural network successfully converged after 21 epochs.
        -------------------------
        ||||| ROUND 1 STATS |||||:
        -------------------------
        Epochs trained: 21
        Best validation performance: 0.1272
        -------------------------
        
lps tensor([ 1.6511, -2.2088, -4.5915,  ...,  0.3864,  1.8933, -6.8822])
self.thr tensor(-16.8043)
Remaining: -9827The classifier rejected 0.7300% of all samples. You will get a speed-up of 0.7%.
Remaining: 69Remaining: -9856The classifier rejected 0.7200% of all samples. You will get a speed-up of 0.7%.
 Training neural network. Epochs trained: 1 Training neural network. Epochs trained: 2 Training neural network. Epochs trained: 3 Training neural network. Epochs trained: 4 Training neural network. Epochs trained: 5 Training neural network. Epochs trained: 6 Training neural network. Epochs trained: 7 Training neural network. Epochs trained: 8 Training neural network. Epochs trained: 9 Training neural network. Epochs trained: 10 Training neural network. Epochs trained: 11 Training neural network. Epochs trained: 12 Training neural network. Epochs trained: 13 Training neural network. Epochs trained: 14 Training neural network. Epochs trained: 15 Training neural network. Epochs trained: 16 Training neural network. Epochs trained: 17 Training neural network. Epochs trained: 18 Training neural network. Epochs trained: 19 Training neural network. Epochs trained: 20 Training neural network. Epochs trained: 21 Neural network successfully converged after 21 epochs.
        -------------------------
        ||||| ROUND 1 STATS |||||:
        -------------------------
        Epochs trained: 21
        Best validation performance: -0.1726
        -------------------------
        
lps tensor([ 3.9985,  1.0101,  0.8520,  ...,  0.5052, -0.0300, -1.3582])
self.thr tensor(-17.0521)
[2022-04-17 21:19:22,667][__main__][INFO] - Finished run
[2022-04-17 21:19:23,274][__main__][INFO] - Draw posterior predictive samples
[2022-04-17 21:19:23,496][__main__][INFO] - Compute all metrics
[2022-04-17 21:19:23,683][__main__][INFO] - Loaded 10000 samples from reference and algorithm
[2022-04-17 21:19:24,129][__main__][INFO] - Computing C2ST
[2022-04-17 21:25:46,027][__main__][INFO] - C2ST: [0.7565]
[2022-04-17 21:25:46,030][__main__][INFO] - Computing MMD
[2022-04-17 21:25:49,349][__main__][INFO] - MMD: 0.04703998565673828
[2022-04-17 21:25:49,350][__main__][INFO] - Computing KSD_GAUSS
[2022-04-17 21:28:23,932][__main__][INFO] - KSD_GAUSS: 164572.546875
[2022-04-17 21:28:23,935][__main__][INFO] - Computing MEDDIST
[2022-04-17 21:28:23,945][__main__][INFO] - MEDDIST: [1.6131868]
[2022-04-17 21:28:23,945][__main__][INFO] - Computing NLTP
[2022-04-17 21:28:23,946][__main__][INFO] - NLTP: 1.7267999649047852
[2022-04-17 21:28:23,946][__main__][INFO] - Computing RT
[2022-04-17 21:28:23,946][__main__][INFO] - RT: 337.08941650390625
metrics_dict {'acceptance rate': [[1.0, -0.00017375548486597836, -0.00015202900976873934, -0.0008694734424352646, -0.0025044004432857037, -0.001893304754048586, -0.0014355465536937118, -0.0027228686958551407, -0.003948262892663479, -0.0031382327433675528]], 'gt in support': [[1.0, 1.0, 1.0, 0.9998000264167786, 0.9998000264167786, 0.9998000264167786, 1.0, 0.9998000264167786, 0.9998000264167786, 1.0]], 'C2ST': array([0.7565], dtype=float32), 'MMD': array(0.04703999, dtype=float32), 'KSD_GAUSS': array(164572.55, dtype=float32), 'MEDDIST': array([1.6131868], dtype=float32), 'NLTP': array(1.7268, dtype=float32), 'RT': array(337.08942, dtype=float32)}
[2022-04-17 21:28:24,477][__main__][INFO] - Metrics:
acceptance rate  [1.0, -0.00017375548486597836, -0.00015202900976873934, -0.0008694734424352646, -0.0025044004432857037, -0.001893304754048586, -0.0014355465536937118, -0.0027228686958551407, -0.003948262892663479, -0.0031382327433675528]
gt in support                                                                                                    [1.0, 1.0, 1.0, 0.9998000264167786, 0.9998000264167786, 0.9998000264167786, 1.0, 0.9998000264167786, 0.9998000264167786, 1.0]
C2ST                                                                                                                                                                                                                                    0.7565
MMD                                                                                                                                                                                                                                    0.04704
KSD_GAUSS                                                                                                                                                                                                                        164572.546875
MEDDIST                                                                                                                                                                                                                               1.613187
NLTP                                                                                                                                                                                                                                    1.7268
RT                                                                                                                                                                                                                                  337.089417
submitit INFO (2022-04-17 21:28:24,669) - Job completed successfully
[2022-04-17 21:28:24,669][submitit][INFO] - Job completed successfully
