submitit INFO (2022-04-17 20:44:42,228) - Starting with JobEnvironment(job_id=1353307_3, hostname=slurm-cpu-hm-8.novalocal, local_rank=0(1), node=0(1), global_rank=0(1))
submitit INFO (2022-04-17 20:44:42,228) - Loading pickle: /mnt/qb/macke/mdeistler57/tsnpe_collection/benchmark/benchmark/../results/2022_04_17/20_44_00_m/.submitit/1353307_3/1353307_3_submitted.pkl
[2022-04-17 20:44:57,055][__main__][INFO] - algorithm:
  name: tsnpe
  params:
    num_rounds: 10
    neural_net: nsf
    hidden_features: 50
    simulation_batch_size: 1000
    training_batch_size: 10000
    z_score_x: independent
    z_score_theta: independent
    num_samples_to_estimate_support: 1000000
    allowed_false_negatives: 1.0e-05
    use_constrained_prior: false
    constrained_prior_quanitle: 0.0
    max_num_epochs: 100000
task:
  name: gaussian_linear
  num_simulations: 1000
  num_observation: 2
compute_metrics: true
seed: null

[2022-04-17 20:44:57,064][__main__][INFO] - sbibm version: 1.0.7
[2022-04-17 20:44:57,064][__main__][INFO] - Seed not specified, generating random seed for replicability
[2022-04-17 20:44:57,065][__main__][INFO] - Random seed: 2980949574
[2022-04-17 20:44:57,199][__main__][INFO] - Start run
[2022-04-17 20:44:57,310][benchmark.run_tsnpe][INFO] - Running SNPE
[2022-04-17 20:44:57,311][benchmark.run_tsnpe][WARNING] - Reduced simulation_batch_size to num_simulation_per_round
[2022-04-17 20:44:57,311][benchmark.run_tsnpe][WARNING] - Reduced training_batch_size to num_simulation_per_round
 Training neural network. Epochs trained: 1 Training neural network. Epochs trained: 2 Training neural network. Epochs trained: 3 Training neural network. Epochs trained: 4 Training neural network. Epochs trained: 5 Training neural network. Epochs trained: 6 Training neural network. Epochs trained: 7 Training neural network. Epochs trained: 8 Training neural network. Epochs trained: 9 Training neural network. Epochs trained: 10 Training neural network. Epochs trained: 11 Training neural network. Epochs trained: 12 Training neural network. Epochs trained: 13 Training neural network. Epochs trained: 14 Training neural network. Epochs trained: 15 Training neural network. Epochs trained: 16 Training neural network. Epochs trained: 17 Training neural network. Epochs trained: 18 Training neural network. Epochs trained: 19 Training neural network. Epochs trained: 20 Training neural network. Epochs trained: 21 Training neural network. Epochs trained: 22 Training neural network. Epochs trained: 23 Training neural network. Epochs trained: 24 Training neural network. Epochs trained: 25 Training neural network. Epochs trained: 26 Training neural network. Epochs trained: 27 Training neural network. Epochs trained: 28 Training neural network. Epochs trained: 29 Training neural network. Epochs trained: 30 Training neural network. Epochs trained: 31 Training neural network. Epochs trained: 32 Training neural network. Epochs trained: 33 Training neural network. Epochs trained: 34 Training neural network. Epochs trained: 35 Training neural network. Epochs trained: 36 Training neural network. Epochs trained: 37 Training neural network. Epochs trained: 38 Training neural network. Epochs trained: 39 Training neural network. Epochs trained: 40 Training neural network. Epochs trained: 41 Training neural network. Epochs trained: 42 Neural network successfully converged after 42 epochs.
        -------------------------
        ||||| ROUND 1 STATS |||||:
        -------------------------
        Epochs trained: 42
        Best validation performance: -2.8230
        -------------------------
        
lps tensor([-1.4277, -1.1104, -1.9116,  ..., -0.8837, -4.2498, -5.1025])
self.thr tensor(-17.7229)
Remaining: -9892The classifier rejected 0.0800% of all samples. You will get a speed-up of 0.1%.
Remaining: 18Remaining: -9973The classifier rejected 0.1350% of all samples. You will get a speed-up of 0.1%.
 Training neural network. Epochs trained: 1 Training neural network. Epochs trained: 2 Training neural network. Epochs trained: 3 Training neural network. Epochs trained: 4 Training neural network. Epochs trained: 5 Training neural network. Epochs trained: 6 Training neural network. Epochs trained: 7 Training neural network. Epochs trained: 8 Training neural network. Epochs trained: 9 Training neural network. Epochs trained: 10 Training neural network. Epochs trained: 11 Training neural network. Epochs trained: 12 Training neural network. Epochs trained: 13 Training neural network. Epochs trained: 14 Training neural network. Epochs trained: 15 Training neural network. Epochs trained: 16 Training neural network. Epochs trained: 17 Training neural network. Epochs trained: 18 Training neural network. Epochs trained: 19 Training neural network. Epochs trained: 20 Training neural network. Epochs trained: 21 Training neural network. Epochs trained: 22 Neural network successfully converged after 22 epochs.
        -------------------------
        ||||| ROUND 1 STATS |||||:
        -------------------------
        Epochs trained: 22
        Best validation performance: -2.5480
        -------------------------
        
lps tensor([-3.5769,  1.5141,  1.3321,  ...,  0.2103,  0.6958, -0.2370])
self.thr tensor(-16.8210)
Remaining: -9890The classifier rejected 0.1000% of all samples. You will get a speed-up of 0.1%.
Remaining: 13Remaining: -9980The classifier rejected 0.1000% of all samples. You will get a speed-up of 0.1%.
 Training neural network. Epochs trained: 1 Training neural network. Epochs trained: 2 Training neural network. Epochs trained: 3 Training neural network. Epochs trained: 4 Training neural network. Epochs trained: 5 Training neural network. Epochs trained: 6 Training neural network. Epochs trained: 7 Training neural network. Epochs trained: 8 Training neural network. Epochs trained: 9 Training neural network. Epochs trained: 10 Training neural network. Epochs trained: 11 Training neural network. Epochs trained: 12 Training neural network. Epochs trained: 13 Training neural network. Epochs trained: 14 Training neural network. Epochs trained: 15 Training neural network. Epochs trained: 16 Training neural network. Epochs trained: 17 Training neural network. Epochs trained: 18 Training neural network. Epochs trained: 19 Training neural network. Epochs trained: 20 Training neural network. Epochs trained: 21 Training neural network. Epochs trained: 22 Training neural network. Epochs trained: 23 Training neural network. Epochs trained: 24 Training neural network. Epochs trained: 25 Training neural network. Epochs trained: 26 Training neural network. Epochs trained: 27 Training neural network. Epochs trained: 28 Training neural network. Epochs trained: 29 Training neural network. Epochs trained: 30 Training neural network. Epochs trained: 31 Training neural network. Epochs trained: 32 Training neural network. Epochs trained: 33 Training neural network. Epochs trained: 34 Training neural network. Epochs trained: 35 Training neural network. Epochs trained: 36 Training neural network. Epochs trained: 37 Training neural network. Epochs trained: 38 Training neural network. Epochs trained: 39 Training neural network. Epochs trained: 40 Training neural network. Epochs trained: 41 Training neural network. Epochs trained: 42 Training neural network. Epochs trained: 43 Training neural network. Epochs trained: 44 Training neural network. Epochs trained: 45 Training neural network. Epochs trained: 46 Training neural network. Epochs trained: 47 Training neural network. Epochs trained: 48 Training neural network. Epochs trained: 49 Training neural network. Epochs trained: 50 Training neural network. Epochs trained: 51 Training neural network. Epochs trained: 52 Training neural network. Epochs trained: 53 Training neural network. Epochs trained: 54 Training neural network. Epochs trained: 55 Training neural network. Epochs trained: 56 Training neural network. Epochs trained: 57 Training neural network. Epochs trained: 58 Training neural network. Epochs trained: 59 Training neural network. Epochs trained: 60 Training neural network. Epochs trained: 61 Training neural network. Epochs trained: 62 Training neural network. Epochs trained: 63 Neural network successfully converged after 63 epochs.
        -------------------------
        ||||| ROUND 1 STATS |||||:
        -------------------------
        Epochs trained: 63
        Best validation performance: -1.9520
        -------------------------
        
lps tensor([ 2.7428, -0.9884,  0.3533,  ...,  0.2744, -1.0652,  1.9566])
self.thr tensor(-16.6753)
Remaining: -9860The classifier rejected 0.4000% of all samples. You will get a speed-up of 0.4%.
Remaining: 34Remaining: -9927The classifier rejected 0.3650% of all samples. You will get a speed-up of 0.4%.
 Training neural network. Epochs trained: 1 Training neural network. Epochs trained: 2 Training neural network. Epochs trained: 3 Training neural network. Epochs trained: 4 Training neural network. Epochs trained: 5 Training neural network. Epochs trained: 6 Training neural network. Epochs trained: 7 Training neural network. Epochs trained: 8 Training neural network. Epochs trained: 9 Training neural network. Epochs trained: 10 Training neural network. Epochs trained: 11 Training neural network. Epochs trained: 12 Training neural network. Epochs trained: 13 Training neural network. Epochs trained: 14 Training neural network. Epochs trained: 15 Training neural network. Epochs trained: 16 Training neural network. Epochs trained: 17 Training neural network. Epochs trained: 18 Training neural network. Epochs trained: 19 Training neural network. Epochs trained: 20 Training neural network. Epochs trained: 21 Training neural network. Epochs trained: 22 Neural network successfully converged after 22 epochs.
        -------------------------
        ||||| ROUND 1 STATS |||||:
        -------------------------
        Epochs trained: 22
        Best validation performance: 0.4106
        -------------------------
        
lps tensor([-0.3250,  3.5560,  3.6283,  ..., -1.1146,  3.1329,  0.0524])
self.thr tensor(-16.7410)
Remaining: -9862The classifier rejected 0.3800% of all samples. You will get a speed-up of 0.4%.
Remaining: 28Remaining: -9944The classifier rejected 0.2800% of all samples. You will get a speed-up of 0.3%.
 Training neural network. Epochs trained: 1 Training neural network. Epochs trained: 2 Training neural network. Epochs trained: 3 Training neural network. Epochs trained: 4 Training neural network. Epochs trained: 5 Training neural network. Epochs trained: 6 Training neural network. Epochs trained: 7 Training neural network. Epochs trained: 8 Training neural network. Epochs trained: 9 Training neural network. Epochs trained: 10 Training neural network. Epochs trained: 11 Training neural network. Epochs trained: 12 Training neural network. Epochs trained: 13 Training neural network. Epochs trained: 14 Training neural network. Epochs trained: 15 Training neural network. Epochs trained: 16 Training neural network. Epochs trained: 17 Training neural network. Epochs trained: 18 Training neural network. Epochs trained: 19 Training neural network. Epochs trained: 20 Training neural network. Epochs trained: 21 Neural network successfully converged after 21 epochs.
        -------------------------
        ||||| ROUND 1 STATS |||||:
        -------------------------
        Epochs trained: 21
        Best validation performance: 0.1596
        -------------------------
        
lps tensor([ 1.9212,  3.7144, -0.3151,  ..., -0.2352, -1.0972, -0.2713])
self.thr tensor(-16.6932)
Remaining: -9867The classifier rejected 0.3300% of all samples. You will get a speed-up of 0.3%.
Remaining: 35Remaining: -9915The classifier rejected 0.4250% of all samples. You will get a speed-up of 0.4%.
 Training neural network. Epochs trained: 1 Training neural network. Epochs trained: 2 Training neural network. Epochs trained: 3 Training neural network. Epochs trained: 4 Training neural network. Epochs trained: 5 Training neural network. Epochs trained: 6 Training neural network. Epochs trained: 7 Training neural network. Epochs trained: 8 Training neural network. Epochs trained: 9 Training neural network. Epochs trained: 10 Training neural network. Epochs trained: 11 Training neural network. Epochs trained: 12 Training neural network. Epochs trained: 13 Training neural network. Epochs trained: 14 Training neural network. Epochs trained: 15 Training neural network. Epochs trained: 16 Training neural network. Epochs trained: 17 Training neural network. Epochs trained: 18 Training neural network. Epochs trained: 19 Training neural network. Epochs trained: 20 Training neural network. Epochs trained: 21 Neural network successfully converged after 21 epochs.
        -------------------------
        ||||| ROUND 1 STATS |||||:
        -------------------------
        Epochs trained: 21
        Best validation performance: -0.3292
        -------------------------
        
lps tensor([-3.3915,  1.7012, -5.4985,  ..., -3.1439,  3.2334, -3.1306])
self.thr tensor(-16.6678)
Remaining: -9856The classifier rejected 0.4400% of all samples. You will get a speed-up of 0.4%.
Remaining: 32Remaining: -9937The classifier rejected 0.3150% of all samples. You will get a speed-up of 0.3%.
 Training neural network. Epochs trained: 1 Training neural network. Epochs trained: 2 Training neural network. Epochs trained: 3 Training neural network. Epochs trained: 4 Training neural network. Epochs trained: 5 Training neural network. Epochs trained: 6 Training neural network. Epochs trained: 7 Training neural network. Epochs trained: 8 Training neural network. Epochs trained: 9 Training neural network. Epochs trained: 10 Training neural network. Epochs trained: 11 Training neural network. Epochs trained: 12 Training neural network. Epochs trained: 13 Training neural network. Epochs trained: 14 Training neural network. Epochs trained: 15 Training neural network. Epochs trained: 16 Training neural network. Epochs trained: 17 Training neural network. Epochs trained: 18 Training neural network. Epochs trained: 19 Training neural network. Epochs trained: 20 Training neural network. Epochs trained: 21 Training neural network. Epochs trained: 22 Training neural network. Epochs trained: 23 Training neural network. Epochs trained: 24 Neural network successfully converged after 24 epochs.
        -------------------------
        ||||| ROUND 1 STATS |||||:
        -------------------------
        Epochs trained: 24
        Best validation performance: 0.0042
        -------------------------
        
lps tensor([-1.2649, -2.0896,  1.5744,  ..., -0.7253,  0.9450, -1.2454])
self.thr tensor(-16.5253)
Remaining: -9852The classifier rejected 0.4800% of all samples. You will get a speed-up of 0.5%.
Remaining: 45Remaining: -9905The classifier rejected 0.4750% of all samples. You will get a speed-up of 0.5%.
 Training neural network. Epochs trained: 1 Training neural network. Epochs trained: 2 Training neural network. Epochs trained: 3 Training neural network. Epochs trained: 4 Training neural network. Epochs trained: 5 Training neural network. Epochs trained: 6 Training neural network. Epochs trained: 7 Training neural network. Epochs trained: 8 Training neural network. Epochs trained: 9 Training neural network. Epochs trained: 10 Training neural network. Epochs trained: 11 Training neural network. Epochs trained: 12 Training neural network. Epochs trained: 13 Training neural network. Epochs trained: 14 Training neural network. Epochs trained: 15 Training neural network. Epochs trained: 16 Training neural network. Epochs trained: 17 Training neural network. Epochs trained: 18 Training neural network. Epochs trained: 19 Training neural network. Epochs trained: 20 Training neural network. Epochs trained: 21 Training neural network. Epochs trained: 22 Training neural network. Epochs trained: 23 Training neural network. Epochs trained: 24 Training neural network. Epochs trained: 25 Training neural network. Epochs trained: 26 Neural network successfully converged after 26 epochs.
        -------------------------
        ||||| ROUND 1 STATS |||||:
        -------------------------
        Epochs trained: 26
        Best validation performance: -0.1092
        -------------------------
        
lps tensor([ 4.3111, -2.2872,  2.1957,  ...,  3.9627,  2.1122,  1.3840])
self.thr tensor(-17.0168)
Remaining: -9829The classifier rejected 0.7100% of all samples. You will get a speed-up of 0.7%.
Remaining: 84Remaining: -9861The classifier rejected 0.6950% of all samples. You will get a speed-up of 0.7%.
 Training neural network. Epochs trained: 1 Training neural network. Epochs trained: 2 Training neural network. Epochs trained: 3 Training neural network. Epochs trained: 4 Training neural network. Epochs trained: 5 Training neural network. Epochs trained: 6 Training neural network. Epochs trained: 7 Training neural network. Epochs trained: 8 Training neural network. Epochs trained: 9 Training neural network. Epochs trained: 10 Training neural network. Epochs trained: 11 Training neural network. Epochs trained: 12 Training neural network. Epochs trained: 13 Training neural network. Epochs trained: 14 Training neural network. Epochs trained: 15 Training neural network. Epochs trained: 16 Training neural network. Epochs trained: 17 Training neural network. Epochs trained: 18 Training neural network. Epochs trained: 19 Training neural network. Epochs trained: 20 Training neural network. Epochs trained: 21 Neural network successfully converged after 21 epochs.
        -------------------------
        ||||| ROUND 1 STATS |||||:
        -------------------------
        Epochs trained: 21
        Best validation performance: 0.6961
        -------------------------
        
lps tensor([ 2.0240, -5.7198,  4.0024,  ...,  1.0915,  2.2246,  0.5659])
self.thr tensor(-16.9473)
Remaining: -9827The classifier rejected 0.7300% of all samples. You will get a speed-up of 0.7%.
Remaining: 84Remaining: -9828The classifier rejected 0.8600% of all samples. You will get a speed-up of 0.9%.
 Training neural network. Epochs trained: 1 Training neural network. Epochs trained: 2 Training neural network. Epochs trained: 3 Training neural network. Epochs trained: 4 Training neural network. Epochs trained: 5 Training neural network. Epochs trained: 6 Training neural network. Epochs trained: 7 Training neural network. Epochs trained: 8 Training neural network. Epochs trained: 9 Training neural network. Epochs trained: 10 Training neural network. Epochs trained: 11 Training neural network. Epochs trained: 12 Training neural network. Epochs trained: 13 Training neural network. Epochs trained: 14 Training neural network. Epochs trained: 15 Training neural network. Epochs trained: 16 Training neural network. Epochs trained: 17 Training neural network. Epochs trained: 18 Training neural network. Epochs trained: 19 Training neural network. Epochs trained: 20 Training neural network. Epochs trained: 21 Neural network successfully converged after 21 epochs.
        -------------------------
        ||||| ROUND 1 STATS |||||:
        -------------------------
        Epochs trained: 21
        Best validation performance: 0.6556
        -------------------------
        
lps tensor([-1.6295,  3.0851,  0.3826,  ...,  1.2284,  4.2516, -1.8662])
self.thr tensor(-16.3606)
[2022-04-17 20:48:29,770][__main__][INFO] - Finished run
[2022-04-17 20:48:30,569][__main__][INFO] - Draw posterior predictive samples
[2022-04-17 20:48:30,793][__main__][INFO] - Compute all metrics
[2022-04-17 20:48:30,999][__main__][INFO] - Loaded 10000 samples from reference and algorithm
[2022-04-17 20:48:31,501][__main__][INFO] - Computing C2ST
[2022-04-17 20:54:05,839][__main__][INFO] - C2ST: [0.76075]
[2022-04-17 20:54:05,842][__main__][INFO] - Computing MMD
[2022-04-17 20:54:07,468][__main__][INFO] - MMD: 0.06878829002380371
[2022-04-17 20:54:07,469][__main__][INFO] - Computing KSD_GAUSS
[2022-04-17 20:55:21,117][__main__][INFO] - KSD_GAUSS: 259396.234375
[2022-04-17 20:55:21,120][__main__][INFO] - Computing MEDDIST
[2022-04-17 20:55:21,141][__main__][INFO] - MEDDIST: [1.6439753]
[2022-04-17 20:55:21,141][__main__][INFO] - Computing NLTP
[2022-04-17 20:55:21,142][__main__][INFO] - NLTP: 2.2264928817749023
[2022-04-17 20:55:21,142][__main__][INFO] - Computing RT
[2022-04-17 20:55:21,142][__main__][INFO] - RT: 212.57147216796875
metrics_dict {'acceptance rate': [[1.0, -0.0005867133149877191, -0.000434532092185691, -0.0015880790306255221, -0.001217750832438469, -0.0018497065175324678, -0.001370206824503839, -0.002067819470539689, -0.0030288933776319027, -0.0037510839756578207]], 'gt in support': [[1.0, 1.0, 0.9998999834060669, 0.9997000098228455, 0.9997000098228455, 0.9997000098228455, 0.9997000098228455, 0.9995999932289124, 0.9997000098228455, 0.9997000098228455]], 'C2ST': array([0.76075], dtype=float32), 'MMD': array(0.06878829, dtype=float32), 'KSD_GAUSS': array(259396.23, dtype=float32), 'MEDDIST': array([1.6439753], dtype=float32), 'NLTP': array(2.226493, dtype=float32), 'RT': array(212.57147, dtype=float32)}
[2022-04-17 20:55:21,235][__main__][INFO] - Metrics:
acceptance rate  [1.0, -0.0005867133149877191, -0.000434532092185691, -0.0015880790306255221, -0.001217750832438469, -0.0018497065175324678, -0.001370206824503839, -0.002067819470539689, -0.0030288933776319027, -0.0037510839756578207]
gt in support                                                   [1.0, 1.0, 0.9998999834060669, 0.9997000098228455, 0.9997000098228455, 0.9997000098228455, 0.9997000098228455, 0.9995999932289124, 0.9997000098228455, 0.9997000098228455]
C2ST                                                                                                                                                                                                                               0.76075
MMD                                                                                                                                                                                                                               0.068788
KSD_GAUSS                                                                                                                                                                                                                    259396.234375
MEDDIST                                                                                                                                                                                                                           1.643975
NLTP                                                                                                                                                                                                                              2.226493
RT                                                                                                                                                                                                                              212.571472
submitit INFO (2022-04-17 20:55:21,306) - Job completed successfully
[2022-04-17 20:55:21,306][submitit][INFO] - Job completed successfully
