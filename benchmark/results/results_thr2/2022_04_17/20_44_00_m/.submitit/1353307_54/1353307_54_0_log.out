submitit INFO (2022-04-17 21:55:01,646) - Starting with JobEnvironment(job_id=1353307_54, hostname=slurm-cpu-hm-8.novalocal, local_rank=0(1), node=0(1), global_rank=0(1))
submitit INFO (2022-04-17 21:55:01,647) - Loading pickle: /mnt/qb/macke/mdeistler57/tsnpe_collection/benchmark/benchmark/../results/2022_04_17/20_44_00_m/.submitit/1353307_54/1353307_54_submitted.pkl
[2022-04-17 21:55:19,254][__main__][INFO] - algorithm:
  name: tsnpe
  params:
    num_rounds: 10
    neural_net: nsf
    hidden_features: 50
    simulation_batch_size: 1000
    training_batch_size: 10000
    z_score_x: independent
    z_score_theta: independent
    num_samples_to_estimate_support: 1000000
    allowed_false_negatives: 1.0e-05
    use_constrained_prior: false
    constrained_prior_quanitle: 0.0
    max_num_epochs: 100000
task:
  name: slcp
  num_simulations: 1000
  num_observation: 9
compute_metrics: true
seed: null

[2022-04-17 21:55:19,269][__main__][INFO] - sbibm version: 1.0.7
[2022-04-17 21:55:19,269][__main__][INFO] - Seed not specified, generating random seed for replicability
[2022-04-17 21:55:19,270][__main__][INFO] - Random seed: 4186799585
[2022-04-17 21:55:19,400][__main__][INFO] - Start run
[2022-04-17 21:55:19,456][benchmark.run_tsnpe][INFO] - Running SNPE
[2022-04-17 21:55:19,456][benchmark.run_tsnpe][WARNING] - Reduced simulation_batch_size to num_simulation_per_round
[2022-04-17 21:55:19,456][benchmark.run_tsnpe][WARNING] - Reduced training_batch_size to num_simulation_per_round
 Training neural network. Epochs trained: 1 Training neural network. Epochs trained: 2 Training neural network. Epochs trained: 3 Training neural network. Epochs trained: 4 Training neural network. Epochs trained: 5 Training neural network. Epochs trained: 6 Training neural network. Epochs trained: 7 Training neural network. Epochs trained: 8 Training neural network. Epochs trained: 9 Training neural network. Epochs trained: 10 Training neural network. Epochs trained: 11 Training neural network. Epochs trained: 12 Training neural network. Epochs trained: 13 Training neural network. Epochs trained: 14 Training neural network. Epochs trained: 15 Training neural network. Epochs trained: 16 Training neural network. Epochs trained: 17 Training neural network. Epochs trained: 18 Training neural network. Epochs trained: 19 Training neural network. Epochs trained: 20 Training neural network. Epochs trained: 21 Training neural network. Epochs trained: 22 Training neural network. Epochs trained: 23 Training neural network. Epochs trained: 24 Training neural network. Epochs trained: 25 Training neural network. Epochs trained: 26 Training neural network. Epochs trained: 27 Training neural network. Epochs trained: 28 Training neural network. Epochs trained: 29 Training neural network. Epochs trained: 30 Training neural network. Epochs trained: 31 Training neural network. Epochs trained: 32 Training neural network. Epochs trained: 33 Training neural network. Epochs trained: 34 Training neural network. Epochs trained: 35 Training neural network. Epochs trained: 36 Training neural network. Epochs trained: 37 Training neural network. Epochs trained: 38 Training neural network. Epochs trained: 39 Training neural network. Epochs trained: 40 Training neural network. Epochs trained: 41 Training neural network. Epochs trained: 42 Training neural network. Epochs trained: 43 Training neural network. Epochs trained: 44 Training neural network. Epochs trained: 45 Training neural network. Epochs trained: 46 Training neural network. Epochs trained: 47 Training neural network. Epochs trained: 48 Training neural network. Epochs trained: 49 Training neural network. Epochs trained: 50 Training neural network. Epochs trained: 51 Training neural network. Epochs trained: 52 Training neural network. Epochs trained: 53 Neural network successfully converged after 53 epochs.
        -------------------------
        ||||| ROUND 1 STATS |||||:
        -------------------------
        Epochs trained: 53
        Best validation performance: -10.0899
        -------------------------
        
lps tensor([ -8.4004,  -7.2139,  -8.4991,  ...,  -8.3922, -11.6609,  -9.9299])
self.thr tensor(-14.7970)
Remaining: -9845The classifier rejected 0.5500% of all samples. You will get a speed-up of 0.6%.
Remaining: 62Remaining: -9871The classifier rejected 0.6450% of all samples. You will get a speed-up of 0.6%.
 Training neural network. Epochs trained: 1 Training neural network. Epochs trained: 2 Training neural network. Epochs trained: 3 Training neural network. Epochs trained: 4 Training neural network. Epochs trained: 5 Training neural network. Epochs trained: 6 Training neural network. Epochs trained: 7 Training neural network. Epochs trained: 8 Training neural network. Epochs trained: 9 Training neural network. Epochs trained: 10 Training neural network. Epochs trained: 11 Training neural network. Epochs trained: 12 Training neural network. Epochs trained: 13 Training neural network. Epochs trained: 14 Training neural network. Epochs trained: 15 Training neural network. Epochs trained: 16 Training neural network. Epochs trained: 17 Training neural network. Epochs trained: 18 Training neural network. Epochs trained: 19 Training neural network. Epochs trained: 20 Training neural network. Epochs trained: 21 Training neural network. Epochs trained: 22 Training neural network. Epochs trained: 23 Training neural network. Epochs trained: 24 Training neural network. Epochs trained: 25 Training neural network. Epochs trained: 26 Training neural network. Epochs trained: 27 Training neural network. Epochs trained: 28 Training neural network. Epochs trained: 29 Training neural network. Epochs trained: 30 Training neural network. Epochs trained: 31 Training neural network. Epochs trained: 32 Training neural network. Epochs trained: 33 Training neural network. Epochs trained: 34 Training neural network. Epochs trained: 35 Training neural network. Epochs trained: 36 Training neural network. Epochs trained: 37 Training neural network. Epochs trained: 38 Training neural network. Epochs trained: 39 Training neural network. Epochs trained: 40 Training neural network. Epochs trained: 41 Training neural network. Epochs trained: 42 Training neural network. Epochs trained: 43 Training neural network. Epochs trained: 44 Training neural network. Epochs trained: 45 Training neural network. Epochs trained: 46 Training neural network. Epochs trained: 47 Training neural network. Epochs trained: 48 Training neural network. Epochs trained: 49 Training neural network. Epochs trained: 50 Training neural network. Epochs trained: 51 Training neural network. Epochs trained: 52 Training neural network. Epochs trained: 53 Training neural network. Epochs trained: 54 Training neural network. Epochs trained: 55 Training neural network. Epochs trained: 56 Training neural network. Epochs trained: 57 Training neural network. Epochs trained: 58 Training neural network. Epochs trained: 59 Training neural network. Epochs trained: 60 Training neural network. Epochs trained: 61 Training neural network. Epochs trained: 62 Training neural network. Epochs trained: 63 Training neural network. Epochs trained: 64 Training neural network. Epochs trained: 65 Neural network successfully converged after 65 epochs.
        -------------------------
        ||||| ROUND 1 STATS |||||:
        -------------------------
        Epochs trained: 65
        Best validation performance: -9.0765
        -------------------------
        
lps tensor([-7.8280, -9.2897, -6.4653,  ..., -8.4775, -6.4829, -6.3528])
self.thr tensor(-14.7497)
Remaining: -9814The classifier rejected 0.8600% of all samples. You will get a speed-up of 0.9%.
Remaining: 75Remaining: -9829The classifier rejected 0.8550% of all samples. You will get a speed-up of 0.9%.
 Training neural network. Epochs trained: 1 Training neural network. Epochs trained: 2 Training neural network. Epochs trained: 3 Training neural network. Epochs trained: 4 Training neural network. Epochs trained: 5 Training neural network. Epochs trained: 6 Training neural network. Epochs trained: 7 Training neural network. Epochs trained: 8 Training neural network. Epochs trained: 9 Training neural network. Epochs trained: 10 Training neural network. Epochs trained: 11 Training neural network. Epochs trained: 12 Training neural network. Epochs trained: 13 Training neural network. Epochs trained: 14 Training neural network. Epochs trained: 15 Training neural network. Epochs trained: 16 Training neural network. Epochs trained: 17 Training neural network. Epochs trained: 18 Training neural network. Epochs trained: 19 Training neural network. Epochs trained: 20 Training neural network. Epochs trained: 21 Neural network successfully converged after 21 epochs.
        -------------------------
        ||||| ROUND 1 STATS |||||:
        -------------------------
        Epochs trained: 21
        Best validation performance: -8.3811
        -------------------------
        
lps tensor([-9.9186, -8.3002, -8.0695,  ..., -8.0745, -6.7887, -7.1830])
self.thr tensor(-14.7654)
Remaining: -9811The classifier rejected 0.8900% of all samples. You will get a speed-up of 0.9%.
Remaining: 76Remaining: -9824The classifier rejected 0.8800% of all samples. You will get a speed-up of 0.9%.
 Training neural network. Epochs trained: 1 Training neural network. Epochs trained: 2 Training neural network. Epochs trained: 3 Training neural network. Epochs trained: 4 Training neural network. Epochs trained: 5 Training neural network. Epochs trained: 6 Training neural network. Epochs trained: 7 Training neural network. Epochs trained: 8 Training neural network. Epochs trained: 9 Training neural network. Epochs trained: 10 Training neural network. Epochs trained: 11 Training neural network. Epochs trained: 12 Training neural network. Epochs trained: 13 Training neural network. Epochs trained: 14 Training neural network. Epochs trained: 15 Training neural network. Epochs trained: 16 Training neural network. Epochs trained: 17 Training neural network. Epochs trained: 18 Training neural network. Epochs trained: 19 Training neural network. Epochs trained: 20 Training neural network. Epochs trained: 21 Training neural network. Epochs trained: 22 Training neural network. Epochs trained: 23 Training neural network. Epochs trained: 24 Training neural network. Epochs trained: 25 Training neural network. Epochs trained: 26 Training neural network. Epochs trained: 27 Training neural network. Epochs trained: 28 Training neural network. Epochs trained: 29 Training neural network. Epochs trained: 30 Neural network successfully converged after 30 epochs.
        -------------------------
        ||||| ROUND 1 STATS |||||:
        -------------------------
        Epochs trained: 30
        Best validation performance: -8.8354
        -------------------------
        
lps tensor([ -7.2095,  -8.0583,  -7.2100,  ...,  -7.9216,  -6.4159, -13.1412])
self.thr tensor(-15.0501)
Remaining: -9821The classifier rejected 0.7900% of all samples. You will get a speed-up of 0.8%.
Remaining: 97Remaining: -9821The classifier rejected 0.8950% of all samples. You will get a speed-up of 0.9%.
 Training neural network. Epochs trained: 1 Training neural network. Epochs trained: 2 Training neural network. Epochs trained: 3 Training neural network. Epochs trained: 4 Training neural network. Epochs trained: 5 Training neural network. Epochs trained: 6 Training neural network. Epochs trained: 7 Training neural network. Epochs trained: 8 Training neural network. Epochs trained: 9 Training neural network. Epochs trained: 10 Training neural network. Epochs trained: 11 Training neural network. Epochs trained: 12 Training neural network. Epochs trained: 13 Training neural network. Epochs trained: 14 Training neural network. Epochs trained: 15 Training neural network. Epochs trained: 16 Training neural network. Epochs trained: 17 Training neural network. Epochs trained: 18 Training neural network. Epochs trained: 19 Training neural network. Epochs trained: 20 Training neural network. Epochs trained: 21 Training neural network. Epochs trained: 22 Training neural network. Epochs trained: 23 Training neural network. Epochs trained: 24 Training neural network. Epochs trained: 25 Training neural network. Epochs trained: 26 Training neural network. Epochs trained: 27 Training neural network. Epochs trained: 28 Training neural network. Epochs trained: 29 Training neural network. Epochs trained: 30 Training neural network. Epochs trained: 31 Training neural network. Epochs trained: 32 Training neural network. Epochs trained: 33 Training neural network. Epochs trained: 34 Training neural network. Epochs trained: 35 Neural network successfully converged after 35 epochs.
        -------------------------
        ||||| ROUND 1 STATS |||||:
        -------------------------
        Epochs trained: 35
        Best validation performance: -8.3036
        -------------------------
        
lps tensor([-10.4691,  -7.1253,  -8.7634,  ...,  -8.7613,  -7.4634,  -9.5928])
self.thr tensor(-15.2850)
Remaining: -9772The classifier rejected 1.2800% of all samples. You will get a speed-up of 1.3%.
Remaining: 113Remaining: -9758The classifier rejected 1.2100% of all samples. You will get a speed-up of 1.2%.
 Training neural network. Epochs trained: 1 Training neural network. Epochs trained: 2 Training neural network. Epochs trained: 3 Training neural network. Epochs trained: 4 Training neural network. Epochs trained: 5 Training neural network. Epochs trained: 6 Training neural network. Epochs trained: 7 Training neural network. Epochs trained: 8 Training neural network. Epochs trained: 9 Training neural network. Epochs trained: 10 Training neural network. Epochs trained: 11 Training neural network. Epochs trained: 12 Training neural network. Epochs trained: 13 Training neural network. Epochs trained: 14 Training neural network. Epochs trained: 15 Training neural network. Epochs trained: 16 Training neural network. Epochs trained: 17 Training neural network. Epochs trained: 18 Training neural network. Epochs trained: 19 Training neural network. Epochs trained: 20 Training neural network. Epochs trained: 21 Neural network successfully converged after 21 epochs.
        -------------------------
        ||||| ROUND 1 STATS |||||:
        -------------------------
        Epochs trained: 21
        Best validation performance: -8.2818
        -------------------------
        
lps tensor([-8.1595, -9.4085, -7.6246,  ..., -7.4917, -7.5383, -7.6821])
self.thr tensor(-15.5988)
Remaining: -9770The classifier rejected 1.3000% of all samples. You will get a speed-up of 1.3%.
Remaining: 106Remaining: -9790The classifier rejected 1.0500% of all samples. You will get a speed-up of 1.1%.
 Training neural network. Epochs trained: 1 Training neural network. Epochs trained: 2 Training neural network. Epochs trained: 3 Training neural network. Epochs trained: 4 Training neural network. Epochs trained: 5 Training neural network. Epochs trained: 6 Training neural network. Epochs trained: 7 Training neural network. Epochs trained: 8 Training neural network. Epochs trained: 9 Training neural network. Epochs trained: 10 Training neural network. Epochs trained: 11 Training neural network. Epochs trained: 12 Training neural network. Epochs trained: 13 Training neural network. Epochs trained: 14 Training neural network. Epochs trained: 15 Training neural network. Epochs trained: 16 Training neural network. Epochs trained: 17 Training neural network. Epochs trained: 18 Training neural network. Epochs trained: 19 Training neural network. Epochs trained: 20 Training neural network. Epochs trained: 21 Neural network successfully converged after 21 epochs.
        -------------------------
        ||||| ROUND 1 STATS |||||:
        -------------------------
        Epochs trained: 21
        Best validation performance: -7.7868
        -------------------------
        
lps tensor([ -7.9426,  -8.6825, -11.5365,  ...,  -6.6744,  -8.6809,  -8.0643])
self.thr tensor(-15.4811)
Remaining: -9760The classifier rejected 1.4000% of all samples. You will get a speed-up of 1.4%.
Remaining: 122Remaining: -9742The classifier rejected 1.2900% of all samples. You will get a speed-up of 1.3%.
 Training neural network. Epochs trained: 1 Training neural network. Epochs trained: 2 Training neural network. Epochs trained: 3 Training neural network. Epochs trained: 4 Training neural network. Epochs trained: 5 Training neural network. Epochs trained: 6 Training neural network. Epochs trained: 7 Training neural network. Epochs trained: 8 Training neural network. Epochs trained: 9 Training neural network. Epochs trained: 10 Training neural network. Epochs trained: 11 Training neural network. Epochs trained: 12 Training neural network. Epochs trained: 13 Training neural network. Epochs trained: 14 Training neural network. Epochs trained: 15 Training neural network. Epochs trained: 16 Training neural network. Epochs trained: 17 Training neural network. Epochs trained: 18 Training neural network. Epochs trained: 19 Training neural network. Epochs trained: 20 Training neural network. Epochs trained: 21 Neural network successfully converged after 21 epochs.
        -------------------------
        ||||| ROUND 1 STATS |||||:
        -------------------------
        Epochs trained: 21
        Best validation performance: -8.0579
        -------------------------
        
lps tensor([-6.4680, -7.7819, -7.3868,  ..., -8.4663, -5.5638, -7.5971])
self.thr tensor(-15.3326)
Remaining: -9768The classifier rejected 1.3200% of all samples. You will get a speed-up of 1.3%.
Remaining: 142Remaining: -9740The classifier rejected 1.3000% of all samples. You will get a speed-up of 1.3%.
 Training neural network. Epochs trained: 1 Training neural network. Epochs trained: 2 Training neural network. Epochs trained: 3 Training neural network. Epochs trained: 4 Training neural network. Epochs trained: 5 Training neural network. Epochs trained: 6 Training neural network. Epochs trained: 7 Training neural network. Epochs trained: 8 Training neural network. Epochs trained: 9 Training neural network. Epochs trained: 10 Training neural network. Epochs trained: 11 Training neural network. Epochs trained: 12 Training neural network. Epochs trained: 13 Training neural network. Epochs trained: 14 Training neural network. Epochs trained: 15 Training neural network. Epochs trained: 16 Training neural network. Epochs trained: 17 Training neural network. Epochs trained: 18 Training neural network. Epochs trained: 19 Training neural network. Epochs trained: 20 Training neural network. Epochs trained: 21 Neural network successfully converged after 21 epochs.
        -------------------------
        ||||| ROUND 1 STATS |||||:
        -------------------------
        Epochs trained: 21
        Best validation performance: -8.1402
        -------------------------
        
lps tensor([-10.1656,  -6.5643,  -6.2695,  ...,  -7.0024,  -6.3016,  -6.9147])
self.thr tensor(-15.3511)
Remaining: -9739The classifier rejected 1.6100% of all samples. You will get a speed-up of 1.6%.
Remaining: 134Remaining: -9729The classifier rejected 1.3550% of all samples. You will get a speed-up of 1.4%.
 Training neural network. Epochs trained: 1 Training neural network. Epochs trained: 2 Training neural network. Epochs trained: 3 Training neural network. Epochs trained: 4 Training neural network. Epochs trained: 5 Training neural network. Epochs trained: 6 Training neural network. Epochs trained: 7 Training neural network. Epochs trained: 8 Training neural network. Epochs trained: 9 Training neural network. Epochs trained: 10 Training neural network. Epochs trained: 11 Training neural network. Epochs trained: 12 Training neural network. Epochs trained: 13 Training neural network. Epochs trained: 14 Training neural network. Epochs trained: 15 Training neural network. Epochs trained: 16 Training neural network. Epochs trained: 17 Training neural network. Epochs trained: 18 Training neural network. Epochs trained: 19 Training neural network. Epochs trained: 20 Training neural network. Epochs trained: 21 Neural network successfully converged after 21 epochs.
        -------------------------
        ||||| ROUND 1 STATS |||||:
        -------------------------
        Epochs trained: 21
        Best validation performance: -7.8645
        -------------------------
        
lps tensor([-6.5425, -8.9671, -8.2729,  ..., -7.3209, -8.0978, -7.3674])
self.thr tensor(-15.3070)
[2022-04-17 21:58:06,435][__main__][INFO] - Finished run
[2022-04-17 21:58:06,942][__main__][INFO] - Draw posterior predictive samples
[2022-04-17 21:58:07,163][__main__][INFO] - Compute all metrics
[2022-04-17 21:58:07,272][__main__][INFO] - Loaded 10000 samples from reference and algorithm
[2022-04-17 21:58:07,744][__main__][INFO] - Computing C2ST
[2022-04-17 21:58:56,049][__main__][INFO] - C2ST: [0.96595]
[2022-04-17 21:58:56,051][__main__][INFO] - Computing MMD
[2022-04-17 21:58:57,484][__main__][INFO] - MMD: 0.18731403350830078
[2022-04-17 21:58:57,485][__main__][INFO] - Computing KSD_GAUSS
[2022-04-17 21:59:50,948][__main__][INFO] - KSD_GAUSS: 826580012105728.0
[2022-04-17 21:59:50,952][__main__][INFO] - Computing MEDDIST
[2022-04-17 21:59:50,964][__main__][INFO] - MEDDIST: [10.178226]
[2022-04-17 21:59:50,964][__main__][INFO] - Computing NLTP
[2022-04-17 21:59:50,965][__main__][INFO] - NLTP: 7.90449857711792
[2022-04-17 21:59:50,965][__main__][INFO] - Computing RT
[2022-04-17 21:59:50,965][__main__][INFO] - RT: 167.0349884033203
metrics_dict {'acceptance rate': [[1.0, -0.0028102712240070105, -0.003729203948751092, -0.003838719567283988, -0.00390445813536644, -0.005287032574415207, -0.0045842076651751995, -0.0056388722732663155, -0.0056828525848686695, -0.005924941971898079]], 'gt in support': [[1.0, 0.9980999827384949, 0.9993000030517578, 0.9993000030517578, 0.9991000294685364, 0.9984999895095825, 0.9993000030517578, 0.9988999962806702, 0.9987000226974487, 0.9986000061035156]], 'C2ST': array([0.96595], dtype=float32), 'MMD': array(0.18731403, dtype=float32), 'KSD_GAUSS': array(8.2658e+14, dtype=float32), 'MEDDIST': array([10.178226], dtype=float32), 'NLTP': array(7.9044986, dtype=float32), 'RT': array(167.03499, dtype=float32)}
[2022-04-17 21:59:51,018][__main__][INFO] - Metrics:
acceptance rate  [1.0, -0.0028102712240070105, -0.003729203948751092, -0.003838719567283988, -0.00390445813536644, -0.005287032574415207, -0.0045842076651751995, -0.0056388722732663155, -0.0056828525848686695, -0.005924941971898079]
gt in support                                  [1.0, 0.9980999827384949, 0.9993000030517578, 0.9993000030517578, 0.9991000294685364, 0.9984999895095825, 0.9993000030517578, 0.9988999962806702, 0.9987000226974487, 0.9986000061035156]
C2ST                                                                                                                                                                                                                             0.96595
MMD                                                                                                                                                                                                                             0.187314
KSD_GAUSS                                                                                                                                                                                                              826580012105728.0
MEDDIST                                                                                                                                                                                                                        10.178226
NLTP                                                                                                                                                                                                                            7.904499
RT                                                                                                                                                                                                                            167.034988
submitit INFO (2022-04-17 21:59:51,074) - Job completed successfully
[2022-04-17 21:59:51,074][submitit][INFO] - Job completed successfully
